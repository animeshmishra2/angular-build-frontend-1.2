<app-header></app-header>
<div class="wh-reports-container">
    <div class="main-card">
        <div class="flex justify-content-between">
            <div class="h1-txt p-2">
                <a appBackButton><mat-icon>arrow_back</mat-icon></a>
                Inventory Report
            </div>
            <div class="flex gap-1 mr-3">
                <p-dropdown [options]="stores" class="p-1" optionValue="idstore_warehouse"
                    optionLabel="name" [(ngModel)]="selectedStore"
                    (onChange)="fetchInventoryReport($event)"
                    placeholder="Select a Store"></p-dropdown>
                <p-dropdown [options]="warehouses" class="p-1" optionValue="idstore_warehouse"
                    optionLabel="name" [(ngModel)]="selectedWarehouse"
                    (onChange)="fetchInventoryReport($event)"
                    placeholder="Select an Inventory"></p-dropdown>
            </div>
        </div>
        <div class="p-2">
            <p-table #dt1 class="p-2" [value]="tableData"
                styleClass="p-datatable-sm p-datatable-gridlines" responsiveLayout="scroll"
                [paginator]="true" [rows]="10" [showCurrentPageReport]="true" class="m-1"
                [tableStyle]="{ 'min-width': '50rem' }"
                currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
                [rowsPerPageOptions]="[10, 50, 100]">
                <ng-template pTemplate="caption">
                    <div class="flex gap-2">
                        <button pButton label="Clear" class="p-button-outlined"
                            icon="pi pi-filter-slash" (click)="dt1.clear()"></button>
                        <p-calendar [(ngModel)]="dateRange" selectionMode="range"
                            placeholder="Choose your date range" [readonlyInput]="true"
                            [appendTo]="'body'"></p-calendar>
                        <button pButton label="Search" class="p-button-outlined p-button-success"
                            icon="pi pi-search" (click)="filterByDate()" [disabled]="!dateRange"></button>
                    </div>
                </ng-template>
                <ng-template pTemplate="header">
                    <tr>
                        <th>Barcode</th>
                        <th>Product Name</th>
                        <th>Category</th>
                        <th>Sub Category</th>
                        <th>Sub Sub Category</th>
                        <th>Brand</th>
                        <th>Quantity Left</th>
                        <!-- <th>Action</th> -->
                    </tr>
                    <tr class="column-filter">
                        <th><p-columnFilter type="text" field="product_barcode"></p-columnFilter>
                        </th>
                        <th><p-columnFilter type="text" field="product_name"></p-columnFilter></th>
                        <th><p-columnFilter type="text" field="category"></p-columnFilter></th>
                        <th><p-columnFilter type="text" field="sub_category"></p-columnFilter></th>
                        <th><p-columnFilter type="text" field="sub_sub_category"></p-columnFilter>
                        </th>
                        <th><p-columnFilter type="text" field="brands"></p-columnFilter>
                        </th>
                        <th><p-columnFilter type="text" field="total_quantity"></p-columnFilter>
                        </th>
                    </tr>
                </ng-template>

                <ng-template pTemplate="body" let-record let-i="rowIndex">
                    <tr>
                        <td>{{ record.product_barcode }}</td>
                        <td>{{ record.product_name }}</td>
                        <td>{{ record.category }}</td>
                        <td>{{ record.sub_category }}</td>
                        <td>{{ record.sub_sub_category }}</td>
                        <td>{{ record.brands }}</td>
                        <td>{{ record.total_quantity }}</td>
                    </tr>
                </ng-template>

                <ng-template pTemplate="emptymessage">
                    <tr>
                        <td class="text-center" colspan="8">No Records Found</td>
                    </tr>
                    <tr>
                        <td class="text-center" colspan="8">Please select Store or Inventory</td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
    </div>
</div>