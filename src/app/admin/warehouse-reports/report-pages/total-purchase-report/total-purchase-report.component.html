<app-header></app-header>
<div class="wh-reports-container">
    <div class="main-card">
        <div class="flex justify-content-between">
            <div class="h1-txt p-2">
                <a appBackButton><mat-icon>arrow_back</mat-icon></a>
                Purchase Report
            </div>
            <!-- <div class="flex gap-1 mr-3">
                <p-dropdown [options]="stores" class="p-1" optionValue="idstore_warehouse"
                    optionLabel="name" [(ngModel)]="selectedStore"
                    (onChange)="fetchProductReport($event,'Store')"
                    placeholder="Select a Store"></p-dropdown>
                <p-dropdown [options]="warehouses" class="p-1" optionValue="idstore_warehouse"
                    optionLabel="name" [(ngModel)]="selectedWarehouse"
                    (onChange)="fetchProductReport($event,'Warehouses')"
                    placeholder="Select an Warehouses"></p-dropdown>
            </div> -->
        </div>
    
        <div class="p-2">
       
            <p-table #dt1 [value]="tableData" responsiveLayout="scroll"
                styleClass="p-datatable-sm p-datatable-gridlines"        [paginator]="false" [rows]="25" [showCurrentPageReport]="true" class="m-1"
                [totalRecords]="totalRecords" [first]="first" [loading]="loading"
                currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries">
                <ng-template pTemplate="caption" >
                    <div class="flex justify-content-between">
                        <div class="flex gap-2">
                            <div class="flex gap-2">
                                <button pButton label="Clear" class="p-button-outlined"
                                    icon="pi pi-filter-slash" (click)="clearAllData(dt1)" ></button>
                                <p-calendar [(ngModel)]="dateRange" selectionMode="range"
                                    placeholder="Choose your date range" [readonlyInput]="true"
                                    [appendTo]="'body'"></p-calendar>
                                <button pButton label="Search" class="p-button-outlined p-button-success"
                                    icon="pi pi-search" (click)="filterByDate()" [disabled]="!dateRange"></button>
                            </div>
                        </div>
                        <div class="flex gap-2">
                            <button mat-raised-button class="success-button" class="resizebtn"
                                (click)="exportExcel()">
                                <mat-icon>article</mat-icon>
                                Export Excel
                            </button>
                            <!-- <button mat-raised-button color="error" class="resizebtn"
                                (click)="exportPdf()">
                                <mat-icon>picture_as_pdf</mat-icon>
                                Export PDF
                            </button> -->
                        </div>
                    </div>
                
                </ng-template>
                <ng-template pTemplate="header">
                    <tr>
                        <th rowspan="2">Product Name</th>
                        <th rowspan="2">Category</th>
                        <th rowspan="2">Sub Category</th>
                        <th rowspan="2">Sub Sub Category</th>
                        <th rowspan="2">Brand</th>
                        <th rowspan="2">Quantity</th>
                        <th class="text-center" colspan="2">GST</th>
                        <th class="text-center" colspan="3">Purchase</th>
                    </tr>
                    <tr class="text-center">
                        <th>CGST</th>
                        <th>SGST</th>
                        <th>Purchase Price</th>
                        <th>Amount</th>
                        <th>Amount with tax</th>
                    </tr>
                    <tr class="column-filter">
                        <th><input pInputText type="text" (input)="dt1.filter($any($event.target).value, 'name', 'contains')"></th>
                        <th><input pInputText type="text" (input)="dt1.filter($any($event.target).value, 'category_name', 'contains')"></th>
                        <th><input pInputText type="text" (input)="dt1.filter($any($event.target).value, 'sub_category_name', 'contains')"></th>
                        <th><input pInputText type="text" (input)="dt1.filter($any($event.target).value, 'sub_sub_category_name', 'contains')"></th>
                        <th><input pInputText type="text" (input)="dt1.filter($any($event.target).value, 'brand_name', 'contains')"></th>
                        <th><input pInputText type="text" (input)="dt1.filter($any($event.target).value, 'quantity', 'contains')"></th>
                        <th><input pInputText type="text" (input)="dt1.filter($any($event.target).value, 'cgst', 'contains')"></th>
                        <th><input pInputText type="text" (input)="dt1.filter($any($event.target).value, 'sgst', 'contains')"></th>
                        <th><input pInputText type="text" (input)="dt1.filter($any($event.target).value, 'purchase_price', 'contains')"></th>
                        <th><input pInputText type="text" (input)="dt1.filter($any($event.target).value, 'amount', 'contains')"></th>
                        <th><input pInputText type="text" (input)="dt1.filter($any($event.target).value, 'total_amount_with_tax', 'contains')"></th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-record>
                    <tr>
                        <td>{{ record.name }}</td>
                        <td>{{ record.category_name }}</td>
                        <td>{{ record.sub_category_name }}</td>
                        <td>{{ record.sub_sub_category_name }}</td>
                        <td>{{ record.brand_name }}</td>
                        <td>{{ record.quantity }}</td>
                        <td>{{ record.cgst }}</td>
                        <td>{{ record.sgst }}</td>
                        <td>{{ record.purchase_price }}</td>
                        <td>{{ record.amount }}</td>
                        <td>{{ record.total_amount_with_tax }}</td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                    <tr>
                        <td class="text-center" colspan="11">No Records Found</td>
                    </tr>
                    <tr>
                        <td class="text-center" colspan="11">Please select Store or Inventory</td>
                    </tr>
                </ng-template>
            </p-table>
            <p-paginator
      
            [first]="first"
            [rows]="25" [showCurrentPageReport]="true"
            currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
            [totalRecords]="totalRecords"
            (onPageChange)="paginate($event)"
          ></p-paginator>
        </div>
    </div>
</div>